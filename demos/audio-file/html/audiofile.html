<!DOCTYPE html>
<html>
    <head>
        <title>Audio File Decoding Demo</title>
        
        <link rel="stylesheet" type="text/css" href="../css/audiofile.css" />
        
        <script src="../../../flocking/flocking-core.js"></script>
        <script src="../../../flocking/flocking-parser.js"></script>
        <script src="../../../flocking/flocking-ugens.js"></script>
        <script src="../../../flocking/flocking-audiofile.js"></script>
        <script src="../../../flocking/flocking-gfx.js"></script>
        
        <script src="../../shared/js/demo-utils.js"></script>
    </head>
    
    <body>
        <h1>Audio File Decoding Demo</h1>
        
        <div class="controls">
            <form class="fileSelector">
                <label for="fileBrowser">Choose a sound file</label>
                <input id="fileBrowser" type="file" />
                <button id="browse">Choose a sound file...</button>
                <span id="filePath"></span>
            </form>
        
            <button id="playButton" class="paused">Play</button>
        </div>
        <div class="view">
            <canvas id="waveform" height="200" width="960"></canvas>
        </div>
        
        <script type="text/javascript">

            var synth = flock.synth({
                ugen: "flock.ugen.scope",

                // The playBuffer ugen plays back audio buffers loaded from a url or file.
                // Currently, Flocking has support for .wav and .aiff files.
                source: {
                    id: "player",
                    ugen: "flock.ugen.playBuffer",
                    buffer: {
                        id: "selectedSound",            // The sound file will be loaded into an environment buffer named "selectedSound."
                        selector: "#fileBrowser"        // The File object selected by the #fileBrowser input element will be read.
                    },
                    speed: 1.0
                },

                options: {
                    canvas: "waveform",
                    styles: {
                        scaleY: 2,
                        strokeColor: "#888",
                        strokeWidth: 3
                    }
                }
            }),
            
            fileSelectorView = demo.fileSelectorView(synth, {
                playerId: "player",
                selectors: {
                    input: "#fileBrowser",
                    button: "#browse",
                    fileName: "#filePath"
                }
            }),
            
            playButtonView = demo.toggleButtonView(synth, "#playButton");
        </script>
    </body>
</html>
